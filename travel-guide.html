<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>True/False Travel</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Emoji:wght@300..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="travel-guide.css?v=1747264000">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="logo-container">
                        <h1 class="logo" id="logoHome">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" class="logo-icon">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            True/False Travel
                        </h1>
                        <button class="info-btn" id="infoBtn" title="How to play">
                            <div class="info-icon">‚ÑπÔ∏è</div>
                        </button>
                    </div>
                    <div class="header-controls">
                        <div class="header-score" id="headerScore" style="display: none;">
                            <span id="headerScoreValue">0</span>
                        </div>
                        <button class="voice-toggle" id="voiceToggle" title="Change writing style">
                            <div class="voice-icon" id="voiceIcon">üìñ</div>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Voice Menu Panel - Initially Hidden -->
        <div class="voice-menu-panel" id="voiceMenuPanel" style="display: none;">
            <div class="voice-menu-header">
                <h3>Writing Style</h3>
                <button class="close-voice-menu" id="closeVoiceMenu">√ó</button>
            </div>
            <div class="voice-menu-body">
                <!-- Year Selector -->
                <div class="year-selector-section">
                    <div class="year-selector-label">Time Period</div>
                    <div class="timeline-scroll-container" id="timelineScrollContainer">
                        <svg class="timeline-svg" id="timelineSvg" viewBox="0 0 5000 120" preserveAspectRatio="none">
                            <!-- Timeline elements will be drawn here -->
                        </svg>
                    </div>
                    <div class="year-display-row">
                        <div class="year-display" id="yearDisplay">Present Day (2025)</div>
                        <button id="recenterBtn" class="btn-recenter" title="Scroll to present day">‚Üª</button>
                    </div>
                    <button id="setTimeBtn" class="btn-set-time" style="display: none;">Set Time & Regenerate</button>
                </div>

                <!-- Custom Voice Input - Moved to top -->
                <div class="custom-voice-input">
                    <div class="custom-voice-label">Create your own voice:</div>
                    <input type="text" id="customVoiceInput" placeholder='e.g., "Alien Anthropologist"' class="custom-voice-field">
                    <button id="createVoiceBtn" class="btn-create-voice">Generate Voice</button>
                    <div id="customVoiceStatus" class="custom-voice-status"></div>
                </div>

                <!-- Custom Voices Section - Generated voices appear here -->
                <div id="customVoicesContainer"></div>

                <!-- Built-in Voices -->
                <div class="builtin-voices-divider">Built-in Voices</div>
                <button class="voice-option" data-voice="parker">
                    <div class="voice-option-emoji">üç∏</div>
                    <div class="voice-option-text">
                        <div class="voice-option-name">Dorothy Parker</div>
                        <div class="voice-option-desc">Razor-sharp wit & biting humor</div>
                    </div>
                </button>
                <button class="voice-option" data-voice="thompson">
                    <div class="voice-option-emoji">üï∂Ô∏è</div>
                    <div class="voice-option-text">
                        <div class="voice-option-name">Hunter S. Thompson</div>
                        <div class="voice-option-desc">Gonzo journalism & dark humor</div>
                    </div>
                </button>
                <button class="voice-option" data-voice="battuta">
                    <div class="voice-option-emoji">üß≠</div>
                    <div class="voice-option-text">
                        <div class="voice-option-name">Ibn Battuta</div>
                        <div class="voice-option-desc">Cultural encounters & customs</div>
                    </div>
                </button>
                <button class="voice-option" data-voice="wodehouse">
                    <div class="voice-option-emoji">üé©</div>
                    <div class="voice-option-text">
                        <div class="voice-option-name">P.G. Wodehouse</div>
                        <div class="voice-option-desc">Absurd charm & British wit</div>
                    </div>
                </button>
                <button class="voice-option" data-voice="keys">
                    <div class="voice-option-emoji">üîë</div>
                    <div class="voice-option-text">
                        <div class="voice-option-name">Man Who Lost His Keys</div>
                        <div class="voice-option-desc">Distracted, scattered thoughts</div>
                    </div>
                </button>
            </div>
        </div>

        <!-- Settings Panel - Initially Hidden -->
        <div class="settings-panel" id="settingsPanel" style="display: none;">
            <div class="settings-header">
                <h3>Settings</h3>
                <button class="close-settings" id="closeSettings">√ó</button>
            </div>
            <div class="settings-body">
                <div class="setting-group">
                    <label for="apiKeyInput">OpenRouter API Key</label>
                    <div id="apiKeyStatus" style="font-size: 0.85em; margin-bottom: 8px; font-weight: 500;"></div>
                    <input type="password" id="apiKeyInput" placeholder="sk-or-v1-... (optional - defaults to free tier)" autocomplete="off">
                    <div style="font-size: 0.8em; color: #888; margin-top: 4px;">
                        Get your free API key at <a href="https://openrouter.ai/keys" target="_blank" style="color: #2196F3;">openrouter.ai/keys</a>
                    </div>
                    <div style="display: flex; gap: 8px; margin-top: 8px;">
                        <button class="btn-save" id="saveApiKey">Save API Key</button>
                        <button class="btn-save" id="resetApiKey" style="background: #666;">Reset to Free Key</button>
                    </div>
                </div>

                <div class="setting-group">
                    <label for="modelSelect">Model</label>
                    <select id="modelSelect">
                        <option value="google/gemini-2.5-flash-lite" selected>Default (Gemini 2.5 Flash Lite)</option>
                        <option value="__custom__">Enter Custom Model...</option>
                    </select>

                    <div id="customModelInput" class="custom-model-input" style="display: none;">
                        <label for="customModelField" style="font-size: 0.875rem; margin-top: 0.75rem; display: block;">Custom OpenRouter Model</label>
                        <input type="text" id="customModelField" placeholder="e.g., google/gemini-2.0-flash-001" class="custom-model-field">
                        <div style="font-size: 0.75rem; color: #888; margin-top: 4px;">
                            Find models at <a href="https://openrouter.ai/models" target="_blank" style="color: #2196F3;">openrouter.ai/models</a>
                        </div>
                        <button class="btn-save" id="saveCustomModel" style="margin-top: 8px;">Use Custom Model</button>
                    </div>
                </div>

                <div class="score-display">
                    <div class="score-label">Score</div>
                    <div class="score-value" id="scoreValue">0</div>
                </div>

                <div class="setting-group">
                    <button class="btn-reset-score" id="resetScoreBtn">Reset Score</button>
                </div>
            </div>
        </div>

        <!-- Info Panel - Initially Hidden -->
        <div class="info-panel" id="infoPanel" style="display: none;">
            <div class="info-panel-header">
                <h3>How to Play</h3>
                <button class="close-info-panel" id="closeInfoPanel">√ó</button>
            </div>
            <div class="info-panel-body">
                <section class="info-section">
                    <h4>The Game</h4>
                    <p>Guess which facts are true and which are false.</p>
                    <ul>
                        <li>Correct: <strong>+1</strong></li>
                        <li>Wrong: <strong>-1</strong></li>
                        <li>Perfect trio: <strong>+5 bonus</strong></li>
                        <li>Perfect page: <strong>+10 bonus</strong></li>
                    </ul>
                </section>

                <section class="info-section">
                    <h4>Exploring</h4>
                    <p>Search or drag the map pin to any destination. Tap bolded place names to explore deeper.</p>
                </section>

                <section class="info-section">
                    <h4>Writing Styles</h4>
                    <p>Tap the icon to choose your narrator‚Äîfrom Dorothy Parker to Hunter S. Thompson, or create your own.</p>
                </section>

                <section class="info-section info-disclaimer">
                    <h4>Disclaimer</h4>
                    <p>AI-generated content for entertainment only. Language models are trained on general knowledge and may inadvertently blend facts with plausible fiction, especially for obscure topics. Don't rely on this for actual travel planning.</p>
                </section>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Search Section -->
                <section id="searchSection" class="search-section">
                    <!-- Search bar first -->
                    <div class="search-input-group">
                        <input type="text" id="locationInput" class="search-input" placeholder="Paris, Tokyo, The Louvre..." autocomplete="off">
                        <button id="exploreBtn" class="btn-explore">
                            <svg viewBox="0 0 24 24" fill="currentColor" style="width: 1.25rem; height: 1.25rem;">
                                <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                            </svg>
                        </button>
                    </div>

                    <!-- Interactive World Map for Home View -->
                    <div class="home-map-container">
                        <div id="homeMap" class="home-map"></div>
                        <button id="nearMeBtn" class="btn-near-me">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 1.25rem; height: 1.25rem;">
                                <circle cx="12" cy="12" r="3"/>
                                <line x1="12" y1="1" x2="12" y2="6"/>
                                <line x1="12" y1="18" x2="12" y2="23"/>
                                <line x1="1" y1="12" x2="6" y2="12"/>
                                <line x1="18" y1="12" x2="23" y2="12"/>
                            </svg>
                        </button>
                    </div>

                    <button id="exploreMapBtn" class="btn-explore-map">
                        <svg viewBox="0 0 24 24" fill="currentColor" style="width: 1.25rem; height: 1.25rem;">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                        </svg>
                        Explore This Location
                    </button>

                    <div class="search-card">
                        <div class="quick-suggestions" id="quickSuggestions">
                            <span class="suggestion-label">Try these:</span>
                            <!-- Dynamically generated suggestion chips will appear here -->
                        </div>
                    </div>
                </section>

                <!-- Place Content Section -->
                <section id="placeSection" class="place-section" style="display: none;">
                    <!-- Hero Image for Place -->
                    <div class="place-hero" id="placeHero">
                        <img id="placeHeroImage" src="" alt="" style="display: none;">
                    </div>

                    <div class="place-nav">
                        <button id="backBtn" class="btn-back">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                            </svg>
                            Back
                        </button>
                        <div class="breadcrumb" id="breadcrumb"></div>
                    </div>

                    <div class="place-header">
                        <h1 id="placeName" class="place-name"></h1>
                        <p id="placeType" class="place-type"></p>
                    </div>

                    <!-- Hidden map for speed -->
                    <div class="map-container">
                        <div id="map" class="map"></div>
                    </div>

                    <div id="categoriesContainer" class="categories-container"></div>

                    <div id="loadingState" class="loading-state" style="display: none;">
                        <div class="spinner"></div>
                        <p id="loadingText">Generating your travel guide...</p>
                    </div>

                    <!-- Bottom Map for Exploration -->
                    <div id="bottomMapContainer" class="bottom-map-container" style="display: none;">
                        <div id="bottomMap" class="bottom-map"></div>
                    </div>

                    <button id="exploreBottomMapBtn" class="btn-explore-bottom-map" style="display: none;">
                        <svg viewBox="0 0 24 24" fill="currentColor" style="width: 1.25rem; height: 1.25rem;">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                        </svg>
                        Explore This Location
                    </button>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <button class="footer-settings-btn" id="footerSettingsBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="settings-icon">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v6m0 6v6m9-9h-6m-6 0H3m15.36 6.36l-4.24-4.24M9.88 9.88L5.64 5.64m12.72 0l-4.24 4.24M9.88 14.12l-4.24 4.24"></path>
                    </svg>
                    Settings
                </button>
                <p>True/False Travel</p>
                <p>AI-generated content for entertainment</p>
                <p class="footer-model">Content generated using <span id="footerModelName">Gemini 2.5 Flash Lite</span></p>
                <p class="footer-credits">Developed by Nate Barksdale entirely using Claude Code on an iPhone, during spare moments over the course of a weekend. Note that the true/false distinction may be iffy when things get weird.</p>
            </div>
        </footer>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="travel-guide.js?v=1747264000"></script>
</body>
</html>
